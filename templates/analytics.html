button{% extends "boiler.html" %}

{% block title %} Analytics {% endblock %}

{% block head %}
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <script>
    window.analyticsData = {
        monthLabels: {{ month_data | map(attribute='month') | list | tojson }},
        monthValues: {{ month_data | map(attribute='total') | list | tojson }},
        dayLabels: {{ day_data | map(attribute='day') | list | tojson }},
        dayValues: {{ day_data | map(attribute='total') | list | tojson }},
        yearLabels: {{ year_data | map(attribute='year') | list | tojson }},
        yearValues: {{ year_data | map(attribute='total') | list | tojson }}
    };
    </script>
    <script src="{{ url_for('static', filename='analytics.js') }}"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='/styles/analytics.css') }}">

{% endblock %}

{% block content %}

<main>
    <div id="left">
        <h2>Analytics</h2>
        <div style="display: flex;">
          <button class="toggle-button" id='monthButton' style="border-radius: 10px 0px 0px 10px; border-right: 2px solid rgba(106,146,207,0.5)">Month</button>
          <button class="toggle-button">Day</button>
          <button class="toggle-button" style="border-radius: 0 10px 10px 0; border-left: 2px solid rgba(106,146,207,0.5)">Year</button>
          </div>
        
        <div style="width: 600px;">
          <canvas id="salesChart"></canvas>
        </div>
        
        <div id="revenue">
          <h3>This Month</h3>
          <div style="display: flex; gap: 30%; width: 75%; justify-content: center;">
              <p><b style="color: 88A7F8;">{{ this_month_orders }}</b><br> Orders</p>
              <p><b style="color: 88A7F8">${{ this_month_revenue }}</b><br> Revenue</p>
          </div>
        </div>
    </div>
    
    <div id="right">
        <div class="card" style="background: #33233A; text-align: left;">    
            <div id="best_seller">
              <h3 style="color:#57D581; margin-top: 0;">Best Seller - {{ best_seller.name }}</h3>
              <div style="display: flex; justify-content: space-between; padding: 0 15% ;">
                {% if best_seller.image == None %}
                  <img src="{{url_for('static', filename='/uploads/placeholder.svg')}}" width="60">

                {% else %}
                  <img src="{{url_for('static', filename='/uploads/' ~  best_seller.image )}}" width="60">
                {% endif %}
                  <div>
                      ${{ best_seller.revenue }}<br><br>
                      {{ best_seller.orders }} Orders
                  </div>
              </div>
            </div>
            
            <div id="worst_seller">
              <h3 style="color:#EA7E7E">Worst Seller - {{ worst_seller.name }}</h3>
              <div style="display: flex; justify-content: space-between; padding: 0 15% ;">
                {% if worst_seller.image == None %}
                  <img src="{{url_for('static', filename='/uploads/placeholder.svg')}}" width="60">

                {% else %}
                  <img src="{{url_for('static', filename='/uploads/' ~  worst_seller.image )}}" width="60">
                {% endif %}
                <div>
                    ${{ worst_seller.revenue }}<br><br>
                    {{ worst_seller.orders }} Orders
                </div>
              </div>
            </div>
        </div>
        
        <div class="card" style="background: #241640">
          <h3 style="margin-top: 0;">Order Summary</h3>
          <div style="color: white">
            <div class="labels">
              <h4>Order ID</h4>
              <h4>Total</h4>
              <h4>Status</h4>
            </div>
            <div style="max-height: 20vh; overflow-y: scroll;">
              {% for order in order_summary[:3] %}
                <div class="order">
                  <p>{{ order.order_id }}</p>
                  <p>${{ order.total }}</p>
                  <span class="{{ 'completed' if order.status == 'Complete' else 'processing' }}">{{ order.status }}</span>
                </div>
              {% endfor %}
            </div>
          </div>
        </div>
    </div>
</main>


  {% endblock %}
